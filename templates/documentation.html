<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Documentation - CapGenie CLI</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
    <style>
        /* Documentation-specific styles */
        .docs-container {
            display: flex;
            min-height: calc(100vh - 120px);
            background: #f8f9fa;
        }

        .docs-sidebar {
            width: 280px;
            background: #2c3e50;
            color: white;
            padding: 2rem 0;
            overflow-y: auto;
            position: sticky;
            top: 100px;
            height: calc(100vh - 120px);
        }

        .docs-sidebar h3 {
            color: #ecf0f1;
            font-size: 1.1rem;
            margin: 0 0 1rem 0;
            font-weight: 600;
        }

        .docs-sidebar .section-header {
            display: block;
            padding: 0.75rem 2rem;
            color: #ecf0f1;
            text-decoration: none;
            border-left: 3px solid transparent;
            transition: all 0.3s ease;
            font-size: 1.1rem;
            font-weight: 600;
        }

        .docs-sidebar .section-header:hover,
        .docs-sidebar .section-header.active {
            background: #34495e;
            color: white;
            border-left-color: #e74c3c;
        }

        .docs-sidebar ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .docs-sidebar li {
            margin: 0;
        }

        .docs-sidebar a {
            display: block;
            padding: 0.75rem 2rem;
            color: #bdc3c7;
            text-decoration: none;
            border-left: 3px solid transparent;
            transition: all 0.3s ease;
            font-size: 0.95rem;
        }

        .docs-sidebar a:hover,
        .docs-sidebar a.active {
            background: #34495e;
            color: white;
            border-left-color: #3498db;
        }

        .docs-content {
            flex: 1;
            padding: 2rem 3rem;
            max-width: 900px;
        }

        .docs-content h1 {
            color: #2c3e50;
            font-size: 2.5rem;
            margin-bottom: 1rem;
            border-bottom: 3px solid #3498db;
            padding-bottom: 0.5rem;
        }

        .docs-content h2 {
            color: #2c3e50;
            font-size: 1.8rem;
            margin: 2.5rem 0 1rem 0;
            padding-top: 1rem;
            border-top: 1px solid #ecf0f1;
        }

        .docs-content h3 {
            color: #34495e;
            font-size: 1.4rem;
            margin: 2rem 0 0.75rem 0;
        }

        .docs-content h4 {
            color: #34495e;
            font-size: 1.2rem;
            margin: 1.5rem 0 0.5rem 0;
        }

        .docs-content p {
            line-height: 1.7;
            color: #555;
            margin-bottom: 1rem;
        }

        .docs-content ul, .docs-content ol {
            margin: 1rem 0;
            padding-left: 2rem;
        }

        .docs-content li {
            margin: 0.5rem 0;
            line-height: 1.6;
        }

        .code-block {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 1.5rem;
        }

        .function-list {
            margin: 1.5rem 0;
        }

        .function-item {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1rem;
        }

        .function-item h4 {
            color: #2c3e50;
            margin-bottom: 1rem;
            font-size: 1.2rem;
            border-bottom: 2px solid #3498db;
            padding-bottom: 0.5rem;
        }

        .function-item ul {
            margin: 0;
            padding-left: 1.5rem;
        }

        .function-item li {
            margin: 0.5rem 0;
            line-height: 1.6;
        }

                .function-item code {
            background: #e9ecef;
            color: #2c3e50;
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
        }

        .function-item strong {
            color: #e74c3c;
            font-weight: 600;
        }

        .function-item strong code {
            background: #fdf2f2;
            color: #c53030;
            border: 1px solid #fed7d7;
        }

        .parameter-group {
            margin: 2rem 0;
            padding: 1.5rem;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #3498db;
        }

        .parameter-group h4 {
            color: #2c3e50;
            margin: 1rem 0 0.5rem 0;
            font-size: 1.1rem;
        }

        .parameter-notes {
            margin: 2rem 0;
            padding: 1.5rem;
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
        }

        .parameter-notes h3 {
            color: #856404;
            margin-bottom: 1rem;
        }

        .parameter-notes ul {
            margin: 0;
            padding-left: 1.5rem;
        }

        .parameter-notes li {
            margin: 0.5rem 0;
            line-height: 1.6;
        }

        .dependency {
            background: #e3f2fd;
            color: #1565c0;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-size: 0.85rem;
            font-weight: 500;
        }

        .independent {
            background: #e8f5e8;
            color: #2e7d32;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-size: 0.85rem;
            font-weight: 500;
        }

        .command-example {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            margin: 1.5rem 0;
            overflow-x: auto;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .code-block code {
            color: #ecf0f1;
        }

        .command-example {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }

        .command-example h4 {
            color: #2c3e50;
            margin-top: 0;
            margin-bottom: 1rem;
        }

        .parameter-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .parameter-table th {
            background: #3498db;
            color: white;
            padding: 1rem;
            text-align: left;
            font-weight: 600;
        }

        .parameter-table td {
            padding: 1rem;
            border-bottom: 1px solid #ecf0f1;
            vertical-align: top;
        }

        .parameter-table tr:nth-child(even) {
            background: #f8f9fa;
        }

        .parameter-table .required {
            background: #e74c3c;
            color: white;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .parameter-table .optional {
            background: #f39c12;
            color: white;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .feature-card {
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 1.5rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .feature-card h4 {
            color: #2c3e50;
            margin-top: 0;
            margin-bottom: 0.75rem;
        }

        .feature-card p {
            color: #666;
            margin-bottom: 0;
        }

        .alert {
            padding: 1rem;
            border-radius: 6px;
            margin: 1.5rem 0;
            border-left: 4px solid;
        }

        .alert-info {
            background: #d1ecf1;
            border-color: #17a2b8;
            color: #0c5460;
        }

        .alert-warning {
            background: #fff3cd;
            border-color: #ffc107;
            color: #856404;
        }

        .alert-success {
            background: #d4edda;
            border-color: #28a745;
            color: #155724;
        }

        .gui-screenshot {
            max-width: 100%;
            height: auto;
            border: 2px solid #000000;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            margin: 1.5rem 0;
            display: block;
        }

        .screenshot-container {
            text-align: center;
            margin: 2rem 0;
        }

        .screenshot-caption {
            font-style: italic;
            color: #666;
            margin-top: 0.5rem;
            font-size: 0.9rem;
        }

        .section-divider {
            height: 1px;
            background: linear-gradient(to right, transparent, #bdc3c7, transparent);
            margin: 2rem 1rem;
            opacity: 0.6;
        }

        /* Mismatch diagrams */
        .nt-diagram { 
            background: #fff; 
            border: 1px solid #e9ecef; 
            border-radius: 6px; 
            padding: 1rem; 
            margin: 1rem 0; 
            box-shadow: 0 2px 4px rgba(0,0,0,0.06);
        }
        .nt { 
            display: inline-block; 
            width: 24px; 
            height: 24px; 
            line-height: 24px; 
            text-align: center; 
            margin: 0 2px; 
            font-weight: 600; 
            color: #2c3e50; 
            background: #f4f6f8; 
            border-radius: 4px; 
            border: 1px solid #dfe6ee; 
        }
        .nt-sub { background: #ffe8e6; border-color: #ffb3ac; color: #b71c1c; }
        .nt-del { background: #fff7e0; border-color: #ffd666; color: #8a6d3b; }
        .nt-ins { background: #e6f7ff; border-color: #91d5ff; color: #0b6aa2; }
        .legend { margin: 0.5rem 0 1rem; }
        .legend-item { margin-right: 1rem; font-size: 0.9rem; color: #555; }
        .legend-swatch { display: inline-block; width: 12px; height: 12px; border-radius: 2px; margin-right: 6px; vertical-align: -2px; }
        .legend-swatch.nt-sub { background: #ffe8e6; border: 1px solid #ffb3ac; }
        .legend-swatch.nt-del { background: #fff7e0; border: 1px solid #ffd666; }
        .legend-swatch.nt-ins { background: #e6f7ff; border: 1px solid #91d5ff; }
        .nt-grid .nt-row { display: flex; align-items: center; margin: 6px 0; }
        .nt-label { width: 42px; color: #666; font-weight: 600; }
        .nt-gap { background: #fafafa; border: 1px dashed #ccc; color: #bbb; }

        @media (max-width: 768px) {
            .docs-container {
                flex-direction: column;
            }
            
            .docs-sidebar {
                width: 100%;
                height: auto;
                position: relative;
            }
            
            .docs-content {
                padding: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <img src="{{ url_for('static', filename='imgs/lamp.png') }}" alt="capgenie Logo" style="width:56px;height:56px;">
                <h1>capgenie</h1>
            </div>
            <nav class="nav-links">
                <a href="{{ url_for('index') }}">Home</a>

                <a href="{{ url_for('new_dataset') }}">New Dataset</a>
                <a href="{{ url_for('view_datasets') }}">View Previous Datasets</a>
                <a href="{{ url_for('documentation') }}" class="active">Documentation</a>
                <a href="{{ url_for('download') }}">Download</a>
                <a href="{{ url_for('logout') }}" class="logout-btn">Logout ({{ current_user.username }})</a>
            </nav>
        </div>
    </header>

    <div class="docs-container">
        <nav class="docs-sidebar">
            <h3><a href="#cli-section" class="section-header">CapGenie CLI</a></h3>
            <ul>
                <li><a href="#overview">Overview</a></li>
                <li><a href="#installation">Installation</a></li>
                <li><a href="#basic-usage">Basic Usage</a></li>
                <li><a href="#commands">Commands</a></li>
                <li><a href="#parameters">Parameters</a></li>
                <li><a href="#functions">Functions & Methods</a></li>
                <li><a href="#examples">Examples</a></li>
                <li><a href="#features">Features</a></li>
                <li><a href="#troubleshooting">Troubleshooting</a></li>
            </ul>
            
            <div class="section-divider"></div>
            
            <h3><a href="#gui-section" class="section-header">CapGenie GUI</a></h3>
            <ul>
                <li><a href="#gui-overview">Overview</a></li>
                <li><a href="#gui-getting-started">Getting Started</a></li>
                <li><a href="#gui-uploading-data">Uploading Data</a></li>
                <li><a href="#gui-analysis-options">Analysis Options</a></li>
                <li><a href="#gui-mismatches">Mismatch Types</a></li>
                <li><a href="#gui-results">Viewing Results</a></li>
                <li><a href="#gui-visualizations">Visualizations</a></li>
                <li><a href="#gui-troubleshooting">Troubleshooting</a></li>
            </ul>
        </nav>

        <main class="docs-content">
            <section id="cli-section">
                <h1>CapGenie Command Line Interface</h1>
            <p class="alert alert-info">
                <strong>CapGenie CLI</strong> is a powerful command-line tool for advanced DNA sequence analysis, 
                designed for researchers and bioinformaticians working with Next-Generation Sequencing (NGS) data.
            </p>

            <section id="overview">
                <h2>Overview</h2>
                <p>
                    CapGenie CLI provides comprehensive tools for analyzing FASTQ files, processing capsid libraries, 
                    calculating enrichment values, and generating visualizations. The tool is optimized for speed and 
                    accuracy, making it ideal for large-scale genomic studies.
                </p>
                
                <div class="feature-grid">
                    <div class="feature-card">
                        <h4>ðŸ”¬ Sequence Analysis</h4>
                        <p>Advanced algorithms for DNA sequence processing and analysis, providing insights into genetic patterns and variations.</p>
                    </div>
                    <div class="feature-card">
                        <h4>ðŸ“Š Data Visualization</h4>
                        <p>Generate interactive charts and visualizations to understand complex genetic data and identify meaningful patterns.</p>
                    </div>
                    <div class="feature-card">
                        <h4>ðŸ§¬ Capsid Library Analysis</h4>
                        <p>Specialized tools for analyzing AAV9 capsid libraries and evaluating peptide selections.</p>
                    </div>
                    <div class="feature-card">
                        <h4>âš¡ High Performance</h4>
                        <p>Optimized C++ extensions for fast processing of large NGS datasets with minimal memory usage.</p>
                    </div>
                </div>
            </section>

            <section id="installation">
                <h2>Installation</h2>
                <p>CapGenie is available as a Python package that can be installed via pip:</p>
                
                <div class="command-example">
                    <h4>Python Package Installation</h4>
                    <div class="code-block">
                        <code># Install from PyPI<br>
pip install capgenie<br><br>
# Or install in development mode<br>
git clone https://github.com/your-repo/capgenie<br>
cd capgenie<br>
pip install -e .</code>
                    </div>
                </div>

                <div class="alert alert-info">
                    <strong>Requirements:</strong> Python 3.8+, pandas, numpy, scipy, plotly, matplotlib, 
                    biopython, ahocorasick, inquirer, and other dependencies listed in requirements.txt.
                </div>
            </section>

            <section id="basic-usage">
                <h2>Basic Usage</h2>
                <p>The basic command structure for CapGenie CLI is:</p>
                
                <div class="code-block">
                    <code>capgenie [-cf FOO] [-f FOO] [-o FOO] -unk [-s FOO] [-e FOO] -w -qual -bar -cls</code>
                </div>

                <p>Where:</p>
                <ul>
                    <li><code>-cf</code> or <code>--capsidfile</code>: Path to your capsid file</li>
                    <li><code>-f</code> or <code>--folder</code>: Directory containing FASTQ files</li>
                    <li><code>-o</code> or <code>--output</code>: Output directory for results</li>
                    <li><code>-unk</code> or <code>--unknownvariants</code>: Search for unknown variants</li>
                </ul>
            </section>

            <section id="commands">
                <h2>Commands</h2>
                <p>CapGenie CLI supports several analysis modes:</p>

                <table class="parameter-table">
                    <thead>
                        <tr>
                            <th>Command</th>
                            <th>Description</th>
                            <th>Usage</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Peptide Counting</strong></td>
                            <td>Count peptide reads in FASTQ files based on capsid file</td>
                            <td><code>capgenie -cf capsid.csv -f data_folder</code></td>
                        </tr>
                        <tr>
                            <td><strong>Unknown Variants</strong></td>
                            <td>Search for unknown AAV9 reads in FASTQ files</td>
                            <td><code>capgenie -unk -f data_folder</code></td>
                        </tr>
                        <tr>
                            <td><strong>Enrichment Analysis</strong></td>
                            <td>Calculate percentage and enrichment values</td>
                            <td><code>capgenie -cf capsid.csv -e enrichment.fastq</code></td>
                        </tr>
                        <tr>
                            <td><strong>Bubble Charts</strong></td>
                            <td>Generate normal bubble charts</td>
                            <td><code>capgenie -cf capsid.csv -b</code></td>
                        </tr>
                        <tr>
                            <td><strong>Biodistribution</strong></td>
                            <td>Generate biodistribution charts</td>
                            <td><code>capgenie -cf capsid.csv -fd</code></td>
                        </tr>
                        <tr>
                            <td><strong>Denoising</strong></td>
                            <td>Remove bad reads based on quality threshold</td>
                            <td><code>capgenie -qual 20</code></td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <section id="parameters">
                <h2>Parameters</h2>
                <p>Complete list of available parameters organized by dependencies:</p>

                <h3>Core Required Parameters</h3>
                <table class="parameter-table">
                    <thead>
                        <tr>
                            <th>Parameter</th>
                            <th>Type</th>
                            <th>Description</th>
                            <th>Required</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>-f, --folder</code></td>
                            <td>Directory</td>
                            <td>Nested folder containing FASTQ file studies</td>
                            <td><span class="required">Required</span></td>
                        </tr>
                    </tbody>
                </table>

                <h3>Analysis Mode Selection (Mutually Exclusive)</h3>
                <div class="parameter-group">
                    <p><strong>Choose ONE of the following analysis modes:</strong></p>
                    
                    <h4>Mode 1: Known Variants Analysis</h4>
                    <table class="parameter-table">
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Type</th>
                                <th>Description</th>
                                <th>Dependencies</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>-cf, --capsidfile</code></td>
                                <td>File path</td>
                                <td>Path to capsid file containing peptide sequences</td>
                                <td><span class="dependency">Required for known variants</span></td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Mode 2: Unknown Variants Analysis</h4>
                    <table class="parameter-table">
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Type</th>
                                <th>Description</th>
                                <th>Dependencies</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>-unk, --unknownvariants</code></td>
                                <td>Flag</td>
                                <td>Search for unknown variants</td>
                                <td><span class="dependency">Required for unknown variants</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h3>Known Variants Dependencies (requires -cf)</h3>
                <table class="parameter-table">
                    <thead>
                        <tr>
                            <th>Parameter</th>
                            <th>Type</th>
                            <th>Description</th>
                            <th>Dependencies</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>-m, --mismatches</code></td>
                            <td>Integer</td>
                            <td>Number of allowed mismatches</td>
                            <td><span class="dependency">Requires -cf</span></td>
                        </tr>
                        <tr>
                            <td><code>-mt, --mtype</code></td>
                            <td>String</td>
                            <td>Mismatch type specification</td>
                            <td><span class="dependency">Requires -m</span></td>
                        </tr>
                        <tr>
                            <td><code>-mot, --motif</code></td>
                            <td>Flag</td>
                            <td>Find motifs in capsid file</td>
                            <td><span class="dependency">Requires -cf</span></td>
                        </tr>
                    </tbody>
                </table>

                <h3>Unknown Variants Dependencies (requires -unk)</h3>
                <table class="parameter-table">
                    <thead>
                        <tr>
                            <th>Parameter</th>
                            <th>Type</th>
                            <th>Description</th>
                            <th>Dependencies</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>-f1, --flank1</code></td>
                            <td>String</td>
                            <td>Upstream flank sequence</td>
                            <td><span class="dependency">Requires -unk</span></td>
                        </tr>
                        <tr>
                            <td><code>-f2, --flank2</code></td>
                            <td>String</td>
                            <td>Downstream flank sequence</td>
                            <td><span class="dependency">Requires -unk</span></td>
                        </tr>
                        <tr>
                            <td><code>-rf, --refseq</code></td>
                            <td>String</td>
                            <td>Reference sequence (alternative to flank sequences)</td>
                            <td><span class="dependency">Requires -unk, alternative to -f1/-f2</span></td>
                        </tr>
                    </tbody>
                </table>

                <h3>Output and Visualization (Independent)</h3>
                <table class="parameter-table">
                    <thead>
                        <tr>
                            <th>Parameter</th>
                            <th>Type</th>
                            <th>Description</th>
                            <th>Dependencies</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>-o, --output</code></td>
                            <td>Directory</td>
                            <td>Output directory for results</td>
                            <td><span class="independent">Independent</span></td>
                        </tr>
                        <tr>
                            <td><code>-e, --enrichment</code></td>
                            <td>File path</td>
                            <td>Enrichment file path</td>
                            <td><span class="independent">Independent</span></td>
                        </tr>
                        <tr>
                            <td><code>-b, --bubble</code></td>
                            <td>Flag</td>
                            <td>Generate bubble charts</td>
                            <td><span class="independent">Independent</span></td>
                        </tr>
                        <tr>
                            <td><code>-fd, --freq_distribution</code></td>
                            <td>Flag</td>
                            <td>Generate frequency distribution charts</td>
                            <td><span class="independent">Independent</span></td>
                        </tr>
                        <tr>
                            <td><code>-w, --weighted</code></td>
                            <td>Flag</td>
                            <td>Use weighted analysis</td>
                            <td><span class="independent">Independent</span></td>
                        </tr>
                    </tbody>
                </table>

                <h3>Quality Control (Independent)</h3>
                <table class="parameter-table">
                    <thead>
                        <tr>
                            <th>Parameter</th>
                            <th>Type</th>
                            <th>Description</th>
                            <th>Dependencies</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>-qual, --quality_threshold</code></td>
                            <td>Integer</td>
                            <td>Quality threshold for denoising (default: 15)</td>
                            <td><span class="independent">Independent</span></td>
                        </tr>
                    </tbody>
                </table>

                <h3>Session Management (Independent)</h3>
                <table class="parameter-table">
                    <thead>
                        <tr>
                            <th>Parameter</th>
                            <th>Type</th>
                            <th>Description</th>
                            <th>Dependencies</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>-ses, --session</code></td>
                            <td>String</td>
                            <td>Override session name</td>
                            <td><span class="independent">Independent</span></td>
                        </tr>
                        <tr>
                            <td><code>-cls, --clear_cache</code></td>
                            <td>Flag</td>
                            <td>Clear all cache</td>
                            <td><span class="independent">Independent</span></td>
                        </tr>
                    </tbody>
                </table>

                <div class="parameter-notes">
                    <h3>Parameter Dependencies Summary</h3>
                    <ul>
                        <li><strong>Analysis Mode:</strong> You must choose either <code>-cf</code> (known variants) OR <code>-unk</code> (unknown variants)</li>
                        <li><strong>Mismatch Parameters:</strong> <code>-m</code> and <code>-mt</code> only work with <code>-cf</code></li>
                        <li><strong>Flank Sequences:</strong> <code>-f1</code> and <code>-f2</code> only work with <code>-unk</code></li>
                        <li><strong>Reference Sequence:</strong> <code>-rf</code> is an alternative to <code>-f1/-f2</code> when using <code>-unk</code></li>
                        <li><strong>Motif Analysis:</strong> <code>-mot</code> only works with <code>-cf</code></li>
                        <li><strong>Independent Parameters:</strong> Output, visualization, quality control, and session management parameters can be used with any analysis mode</li>
                    </ul>
                </div>
            </section>

            <section id="functions">
                <h2>Functions and Methods</h2>
                <p>Complete list of all functions and methods available in the CapGenie package. <strong>Important functions are highlighted.</strong></p>

                <h3>Main CLI Module (cli.py)</h3>
                <div class="function-list">
                    <div class="function-item">
                        <h4>class cap_genie</h4>
                        <ul>
                            <li><code>__init__(args)</code> - Initialize the main CLI class</li>
                            <li><code>get_files()</code> - Show folders and allow user selection</li>
                            <li><code>denoise_files(instance)</code> - Denoise files based on quality threshold</li>
                            <li><code>run_pipeline()</code> - Execute the main analysis pipeline</li>
                        </ul>
                    </div>
                </div>

                <h3>Search AAV9 Module (search_aav9.py) - Core Analysis Engine</h3>
                <div class="function-list">
                    <div class="function-item">
                        <h4>class search_aav9</h4>
                        <ul>
                            <li><code>__init__()</code> - Initialize search instance</li>
                            <li><strong><code>confirm_peptide(seq, peptide)</code> - Confirm peptide sequence orientation (IMPORTANT)</strong></li>
                            <li><strong><code>find_upstream_downstream(sequences)</code> - Find common flanking sequences (IMPORTANT)</strong></li>
                            <li><strong><code>find_amplicons(trimmed_csv, upstream, downstream)</code> - Extract amplicons (IMPORTANT)</strong></li>
                            <li><strong><code>trim_amplicon_sequence(capsid_file)</code> - Trim amplicon sequences (IMPORTANT)</strong></li>
                            <li><strong><code>create_peptide_map(capsid_file)</code> - Create peptide mapping (IMPORTANT)</strong></li>
                            <li><strong><code>load_dna_seq(fastq_file)</code> - Load DNA sequences from FASTQ (IMPORTANT)</strong></li>
                            <li><strong><code>count_known_reads(peptide_map, fastq_file, data_directory)</code> - Count known peptide reads (CORE FUNCTION)</strong></li>
                            <li><strong><code>search_by_flank(upstream, downstream, fastq_file, data_directory)</code> - Search by flanking sequences (CORE FUNCTION)</strong></li>
                            <li><strong><code>_cpp_fuzzy_match(peptide_map, fastq_file, data_directory, mismatches, subOnly)</code> - Fuzzy matching with C++ backend (CORE FUNCTION)</strong></li>
                            <li><strong><code>_cpp_filter_count(data_directory, fastq_file, refseq)</code> - Filter and count with C++ backend (CORE FUNCTION)</strong></li>
                            <li><code>add_decimal(data_dict, file, merc)</code> - Add decimal column to results</li>
                            <li><strong><code>create_avg_pkl(data_directory, files, instruction_link)</code> - Create average results (IMPORTANT)</strong></li>
                            <li><code>sort_list(lst)</code> - Sort list by frequency</li>
                            <li><strong><code>prune_reads(threshold, sorted_merlist)</code> - Prune similar reads (IMPORTANT)</strong></li>
                            <li><strong><code>translate(dna_seq)</code> - Translate DNA to protein (IMPORTANT)</strong></li>
                            <li><code>save_denoise_result(result, file)</code> - Save denoising results</li>
                            <li><code>_serialize_pkl()</code> - Serialize results to JSON</li>
                            <li><strong><code>init_session()</code> - Initialize analysis session (IMPORTANT)</strong></li>
                            <li><code>_override_session(session_folder)</code> - Override session name</li>
                            <li><code>save_to_output(output_dir)</code> - Save results to output directory</li>
                        </ul>
                    </div>
                </div>

                <h3>Bubble Charts Module (bubble.py)</h3>
                <div class="function-list">
                    <div class="function-item">
                        <ul>
                            <li><code>kv_dict(df, factor)</code> - Convert DataFrame to key-value dictionary</li>
                            <li><code>Set_Color(x)</code> - Set color for bubble chart elements</li>
                            <li><code>gen_bubble_plots(bubble_dir, session_dir, dir)</code> - Generate bubble chart visualizations</li>
                        </ul>
                    </div>
                </div>

                <h3>Biodistribution Module (biodistribution.py)</h3>
                <div class="function-list">
                    <div class="function-item">
                        <ul>
                            <li><code>gen_bio_graphs(freq_dir, session_folder, dir)</code> - Generate biodistribution frequency charts</li>
                        </ul>
                    </div>
                </div>

                <h3>Enrichment Module (enrichment.py)</h3>
                <div class="function-list">
                    <div class="function-item">
                        <h4>class enrichment</h4>
                        <ul>
                            <li><code>__init__(session_folder, sheets_dir, cache_folder)</code> - Initialize enrichment analysis</li>
                            <li><code>process_dict(dic)</code> - Process dictionary to ensure float values</li>
                            <li><code>p2f(x)</code> - Convert percentage to float</li>
                            <li><code>calc_enrichment(pre_insert, session_folder, files, data_directory, instruction_name)</code> - Calculate enrichment values</li>
                        </ul>
                    </div>
                </div>

                <h3>Spreadsheet Module (spreadsheet.py)</h3>
                <div class="function-list">
                    <div class="function-item">
                        <h4>class spreadsheet</h4>
                        <ul>
                            <li><code>__init__(session_dir, sheets_dir, cache_folder)</code> - Initialize spreadsheet handler</li>
                            <li><code>save_file(pkl_file_path, file, data_directory, instruction_link, avg_file, barcode)</code> - Save results to Excel format</li>
                        </ul>
                    </div>
                </div>

                <h3>Motif Analysis Module (motif.py)</h3>
                <div class="function-list">
                    <div class="function-item">
                        <h4>class Motif</h4>
                        <ul>
                            <li><code>__init__(seqs, isProtein)</code> - Initialize motif analysis</li>
                            <li><code>one_hot_encode(seq)</code> - One-hot encode sequences</li>
                            <li><code>cluster_motifs()</code> - Cluster similar motifs</li>
                            <li><code>extract_wildcard_motifs(cluster_seqs, min_len, max_len, max_wildcards, min_count)</code> - Extract wildcard motifs</li>
                            <li><code>get_motifs(file_path)</code> - Get and save motif clusters</li>
                            <li><code>compute_frequencies()</code> - Compute amino acid frequencies</li>
                            <li><code>compute_info_content(freqs)</code> - Compute information content</li>
                            <li><code>createMotifLogo(file_path)</code> - Create motif logo visualization</li>
                        </ul>
                    </div>
                </div>

                <h3>C++ Extension Modules</h3>
                <div class="function-list">
                    <div class="function-item">
                        <h4>mani Module (mani.cpp)</h4>
                        <ul>
                            <li><code>get_cache_folder()</code> - Get system-specific cache folder path</li>
                            <li><code>clear_cache_folder()</code> - Clear all cache data</li>
                            <li><code>formatBytes(pos)</code> - Format bytes to human-readable string</li>
                            <li><code>fastqFileSize(filePath)</code> - Get FASTQ file size</li>
                            <li><code>fastqLineCount(filename)</code> - Count lines in FASTQ file</li>
                            <li><code>split_string(str, delimiter)</code> - Split string by delimiter</li>
                            <li><code>format_element(s, max_length)</code> - Format element for display</li>
                            <li><code>getMaxLength(strings)</code> - Get maximum string length</li>
                            <li><code>pprint_csv(filepath)</code> - Pretty print CSV file</li>
                        </ul>
                    </div>
                    <div class="function-item">
                        <h4>denoise Module (denoise.cpp)</h4>
                        <ul>
                            <li><code>denoise(filename, file_path, output_path, threshold)</code> - Denoise FASTQ files based on quality</li>
                            <li><code>clear_pointers()</code> - Clear memory pointers</li>
                        </ul>
                    </div>
                    <div class="function-item">
                        <h4>filter_module Module (filter_count.cpp)</h4>
                        <ul>
                            <li><code>makeTranslationMap(from, to)</code> - Create translation map</li>
                            <li><code>translateString(input, translationMap)</code> - Translate string using map</li>
                            <li><code>safe_substring(str, start, end)</code> - Safe substring extraction</li>
                            <li><code>process_line(line, ref_seq)</code> - Process FASTQ line</li>
                            <li><code>reset_result(result)</code> - Reset filter result</li>
                            <li><code>reset_pointers(mapped_data, line_start, current_pos)</code> - Reset memory pointers</li>
                            <li><code>filter_count(file, refseq)</code> - Filter and count AAV9 reads</li>
                        </ul>
                    </div>
                    <div class="function-item">
                        <h4>fuzzy_match Module (fuzzy_match.cpp)</h4>
                        <ul>
                            <li><code>hamming_distance(s1, s2)</code> - Calculate Hamming distance</li>
                            <li><code>peptide_levenshtein_distance(s1, s2)</code> - Calculate Levenshtein distance</li>
                            <li><code>count_hamming_matches(query, dna_seq, max_mismatches)</code> - Count Hamming matches</li>
                            <li><code>levenshtein_match_count_thread(query, dna, max_distance, start, end)</code> - Threaded Levenshtein matching</li>
                            <li><code>count_levenstein_matches(query, dna_seq, max_distance)</code> - Count Levenshtein matches</li>
                            <li><code>fuzzy_match(queries, dna_seq, max_mismatch, subOnly)</code> - Main fuzzy matching function</li>
                        </ul>
                    </div>
                </div>
            </section>

            <section id="examples">
                <h2>Examples</h2>
                
                <h3>Command Line Interface Examples</h3>
                
                <div class="command-example">
                    <h4>Basic Peptide Counting</h4>
                    <p>Count peptide reads using a capsid file:</p>
                    <div class="code-block">
                        <code>capgenie -cf capsid_library.csv -f /path/to/fastq/files</code>
                    </div>
                </div>

                <div class="command-example">
                    <h4>Unknown Variant Discovery</h4>
                    <p>Search for unknown AAV9 variants:</p>
                    <div class="code-block">
                        <code>capgenie -unk -f /path/to/fastq/files -f1 "TGCCCAA" -f2 "CCTGTG"</code>
                    </div>
                </div>

                <div class="command-example">
                    <h4>Enrichment Analysis with Visualization</h4>
                    <p>Calculate enrichment and generate charts:</p>
                    <div class="code-block">
                        <code>capgenie -cf capsid.csv -f data_folder -e enrichment.fastq -b -fd</code>
                    </div>
                </div>

                <div class="command-example">
                    <h4>Quality Control and Denoising</h4>
                    <p>Remove low-quality reads before analysis:</p>
                    <div class="code-block">
                        <code>capgenie -cf capsid.csv -f data_folder -qual 20</code>
                    </div>
                </div>

                <div class="command-example">
                    <h4>Motif Analysis</h4>
                    <p>Find sequence motifs in your capsid library:</p>
                    <div class="code-block">
                        <code>capgenie -cf capsid.csv -f data_folder -mot</code>
                    </div>
                </div>

                <div class="command-example">
                    <h4>Fuzzy Matching with Mismatches</h4>
                    <p>Allow up to 2 mismatches in peptide matching:</p>
                    <div class="code-block">
                        <code>capgenie -cf capsid.csv -f data_folder -m 2 -mt "substitution"</code>
                    </div>
                </div>

                <div class="command-example">
                    <h4>Session Management</h4>
                    <p>Use a specific session name for analysis:</p>
                    <div class="code-block">
                        <code>capgenie -cf capsid.csv -f data_folder -ses "my_experiment_2024"</code>
                    </div>
                </div>

                <h3>Python API Examples</h3>

                <div class="command-example">
                    <h4>Creating Peptide Map</h4>
                    <p>Create a peptide mapping from a capsid file:</p>
                    <div class="code-block">
                        <code>from capgenie.search_aav9 import search_aav9<br><br>
# Create peptide map from capsid file<br>
peptide_map = search_aav9.create_peptide_map("capsid_library.csv")<br>
print(f"Loaded {len(peptide_map)} peptides")</code>
                    </div>
                </div>

                <div class="command-example">
                    <h4>Counting Known Reads</h4>
                    <p>Count known peptide reads in a FASTQ file:</p>
                    <div class="code-block">
                        <code>from capgenie.search_aav9 import search_aav9<br><br>
# Initialize search instance<br>
searcher = search_aav9()<br>
searcher.init_session()<br><br>
# Count known reads<br>
peptide_map = search_aav9.create_peptide_map("capsid.csv")<br>
searcher.count_known_reads(peptide_map, "sample.fastq", "experiment_1")</code>
                    </div>
                </div>

                <div class="command-example">
                    <h4>Searching Unknown Variants</h4>
                    <p>Search for unknown variants using flanking sequences:</p>
                    <div class="code-block">
                        <code>from capgenie.search_aav9 import search_aav9<br><br>
# Initialize search instance<br>
searcher = search_aav9()<br>
searcher.init_session()<br><br>
# Search by flanking sequences<br>
upstream = "TGCCCAA"<br>
downstream = "CCTGTG"<br>
searcher.search_by_flank(upstream, downstream, "sample.fastq", "experiment_1")</code>
                    </div>
                </div>

                <div class="command-example">
                    <h4>Fuzzy Matching</h4>
                    <p>Perform fuzzy matching with mismatches:</p>
                    <div class="code-block">
                        <code>from capgenie.search_aav9 import search_aav9<br><br>
# Initialize search instance<br>
searcher = search_aav9()<br>
searcher.init_session()<br><br>
# Fuzzy matching with 2 mismatches<br>
peptide_map = search_aav9.create_peptide_map("capsid.csv")<br>
searcher._cpp_fuzzy_match(peptide_map, "sample.fastq", "experiment_1", 2, subOnly=True)</code>
                    </div>
                </div>

                <div class="command-example">
                    <h4>Generating Bubble Charts</h4>
                    <p>Create bubble chart visualizations:</p>
                    <div class="code-block">
                        <code>from capgenie.bubble import gen_bubble_plots<br><br>
# Generate bubble charts<br>
gen_bubble_plots("bubble_charts/", "session_name", "experiment_1")<br>
print("Bubble charts generated successfully")</code>
                    </div>
                </div>

                <div class="command-example">
                    <h4>Creating Motif Analysis</h4>
                    <p>Analyze sequence motifs in your data:</p>
                    <div class="code-block">
                        <code>from capgenie.motif import Motif<br><br>
# Create peptide map<br>
peptide_map = search_aav9.create_peptide_map("capsid.csv")<br>
peptides = list(peptide_map.values())<br><br>
# Initialize motif analysis<br>
motif = Motif(peptides, isProtein=True)<br><br>
# Get motifs and create logo<br>
motif.get_motifs("output_directory")<br>
motif.createMotifLogo("output_directory")</code>
                    </div>
                </div>

                <div class="command-example">
                    <h4>Enrichment Analysis</h4>
                    <p>Calculate enrichment values:</p>
                    <div class="code-block">
                        <code>from capgenie.enrichment import enrichment<br><br>
# Initialize enrichment analysis<br>
enrich = enrichment("session_name", "sheets_dir", "cache_folder")<br><br>
# Calculate enrichment<br>
files = ["sample1.fastq", "sample2.fastq"]<br>
enrich.calc_enrichment("enrichment.fastq", "session_name", files, "experiment_1", "count_known_reads")</code>
                    </div>
                </div>

                <div class="command-example">
                    <h4>DNA Translation</h4>
                    <p>Translate DNA sequences to protein:</p>
                    <div class="code-block">
                        <code>from capgenie.search_aav9 import search_aav9<br><br>
# Translate DNA to protein<br>
dna_seq = "ATGGCTAGCTAA"<br>
protein = search_aav9().translate(dna_seq)<br>
print(f"DNA: {dna_seq}")<br>
print(f"Protein: {protein}")</code>
                    </div>
                </div>

                <div class="command-example">
                    <h4>Quality Denoising</h4>
                    <p>Denoise FASTQ files based on quality threshold:</p>
                    <div class="code-block">
                        <code>from capgenie import denoise<br><br>
# Denoise with quality threshold of 20<br>
result = denoise.denoise("input.fastq", "/path/to/input.fastq", "/output/dir", 20)<br>
print(f"Average quality: {result.avg_quality}")<br>
print(f"Low quality reads removed: {result.low_quality_reads}")<br>
print(f"Output file: {result.output_filename}")</code>
                    </div>
                </div>

                <div class="command-example">
                    <h4>Fuzzy Matching with C++ Backend</h4>
                    <p>Use the high-performance fuzzy matching:</p>
                    <div class="code-block">
                        <code>from capgenie import fuzzy_match<br><br>
# Define queries and DNA sequence<br>
queries = ["ATGGCTAGCTAA", "GCTAGCTAAATG"]<br>
dna_seq = "ATGGCTAGCTAAGCTAGCTAAATGCTAGCTAA"<br><br>
# Perform fuzzy matching<br>
results = fuzzy_match.fuzzy_match(queries, dna_seq.encode(), 2, subOnly=True)<br>
print(f"Match results: {results}")</code>
                    </div>
                </div>

                <div class="command-example">
                    <h4>File Operations</h4>
                    <p>Use utility functions for file operations:</p>
                    <div class="code-block">
                        <code>from capgenie import mani<br><br>
# Get cache folder path<br>
cache_path = mani.get_cache_folder()<br>
print(f"Cache folder: {cache_path}")<br><br>
# Get file size<br>
file_size = mani.fastqFileSize("sample.fastq")<br>
print(f"File size: {file_size}")<br><br>
# Pretty print CSV<br>
mani.pprint_csv("capsid.csv")</code>
                    </div>
                </div>
            </section>

            <section id="features">
                <h2>Advanced Features</h2>
                
                <h3>Session Management</h3>
                <p>CapGenie CLI supports session management for long-running analyses:</p>
                <div class="code-block">
                    <code>capgenie -cf capsid.csv -f data_folder -ses "my_analysis_session"</code>
                </div>

                <h3>Cache Management</h3>
                <p>Clear cache when needed to free up disk space:</p>
                <div class="code-block">
                    <code>capgenie -cls</code>
                </div>

                <h3>Output Formats</h3>
                <p>Results are saved in multiple formats:</p>
                <ul>
                    <li><strong>Excel (.xlsx):</strong> Spreadsheet format for easy analysis</li>
                    <li><strong>CSV:</strong> Comma-separated values for data processing</li>
                    <li><strong>Pickle (.pkl):</strong> Python serialized format for programmatic access</li>
                    <li><strong>JSON:</strong> Structured data format for web applications</li>
                </ul>
            </section>

            <section id="troubleshooting">
                <h2>Troubleshooting</h2>
                
                <h3>Common Issues</h3>
                
                <div class="alert alert-warning">
                    <strong>File Not Found:</strong> Ensure all file paths are correct and files exist.
                </div>
                
                <div class="alert alert-warning">
                    <strong>Memory Issues:</strong> For large datasets, consider using quality filtering to reduce memory usage.
                </div>
                
                <div class="alert alert-warning">
                    <strong>Permission Errors:</strong> Make sure you have read/write permissions for input and output directories.
                </div>

                <h3>Performance Tips</h3>
                <ul>
                    <li>Use quality threshold filtering to reduce dataset size</li>
                    <li>Process datasets in smaller batches for very large files</li>
                    <li>Ensure sufficient disk space for temporary files</li>
                    <li>Use SSD storage for faster I/O operations</li>
                </ul>

                <h3>Getting Help</h3>
                <p>For additional support and examples, refer to the built-in help:</p>
                <div class="code-block">
                    <code>capgenie --help</code>
                </div>
            </section>
            </section>

            <!-- GUI Documentation Section -->
            <section id="gui-section">
            <section id="gui-overview">
                <h2>CapGenie Graphical User Interface</h2>
                <p class="alert alert-info">
                    <strong>CapGenie GUI</strong> provides an intuitive web-based interface for DNA sequence analysis, 
                    making advanced bioinformatics accessible to researchers without command-line experience.
                </p>

                <p>
                    The CapGenie GUI offers a user-friendly alternative to the command-line interface, providing 
                    the same powerful analysis capabilities through an intuitive web interface. Users can upload 
                    datasets, configure analysis parameters, and view results through interactive visualizations.
                </p>
                
                <div class="feature-grid">
                    <div class="feature-card">
                        <h4>ðŸŒ Web-Based Interface</h4>
                        <p>Access CapGenie from any modern web browser without installation or command-line knowledge.</p>
                    </div>
                    <div class="feature-card">
                        <h4>ðŸ“ Drag & Drop Upload</h4>
                        <p>Easily upload FASTQ files and capsid libraries using intuitive drag-and-drop functionality.</p>
                    </div>
                    <div class="feature-card">
                        <h4>âš™ï¸ Visual Configuration</h4>
                        <p>Configure analysis parameters through user-friendly forms and checkboxes.</p>
                    </div>
                    <div class="feature-card">
                        <h4>ðŸ“Š Interactive Results</h4>
                        <p>View analysis results through interactive charts, tables, and downloadable reports.</p>
                    </div>
                </div>
            </section>

            <section id="gui-getting-started">
                <h2>Getting Started with CapGenie GUI</h2>
                
                <h3>Accessing the Interface</h3>
                <p>The CapGenie GUI is accessible through your web browser. Simply navigate to the application URL and log in with your credentials.</p>
                
                <h3>Main Navigation</h3>
                <p>The interface consists of several main sections:</p>
                <ul>
                    <li><strong>Home:</strong> Overview dashboard with recent datasets and quick actions</li>
                    <li><strong>New Dataset:</strong> Upload and configure new analysis datasets</li>
                    <li><strong>View Previous Datasets:</strong> Access and manage existing datasets</li>
                    <li><strong>Documentation:</strong> This help section</li>
                    <li><strong>Download:</strong> Access CLI tools and additional resources</li>
                </ul>

                <h3>User Account Management</h3>
                <p>Each user has their own account with:</p>
                <ul>
                    <li>Personal dataset storage</li>
                    <li>Analysis history tracking</li>
                    <li>Customizable preferences</li>
                    <li>Secure data isolation</li>
                </ul>
            </section>

            <section id="gui-uploading-data">
                <h2>Uploading Data</h2>
                
                <h3>Supported File Formats</h3>
                <p>The GUI supports the same file formats as the CLI:</p>
                <ul>
                    <li><strong>FASTQ files:</strong> Next-generation sequencing data files</li>
                    <li><strong>CSV files:</strong> Capsid library files containing peptide sequences</li>
                    <li><strong>Directory structures:</strong> Maintain your existing folder organization</li>
                </ul>

                <h3>Upload Process</h3>
                                 <div class="command-example">
                     <h4>Step 1: Navigate to New Dataset</h4>
                     <p>Click on "New Dataset" in the main navigation menu.</p>
                     <div class="screenshot-container">
                         <img src="{{ url_for('static', filename='imgs/input_capgenie.png') }}" alt="New Dataset Interface" class="gui-screenshot">
                         <div class="screenshot-caption">New Dataset upload interface with drag-and-drop functionality</div>
                     </div>
                 </div>

                <div class="command-example">
                    <h4>Step 2: Enter Dataset Information</h4>
                    <p>Provide a descriptive name for your dataset to help with organization.</p>
                </div>

                <div class="command-example">
                    <h4>Step 3: Upload Files</h4>
                    <p>Use the drag-and-drop interface to upload your files:</p>
                    <ul>
                        <li>Drag files directly from your file explorer</li>
                        <li>Or click to browse and select files</li>
                        <li>Maintain folder structure by uploading entire directories</li>
                    </ul>
                </div>

                <div class="command-example">
                    <h4>Step 4: Review and Confirm</h4>
                    <p>Review the uploaded files and dataset structure before proceeding to analysis.</p>
                </div>

                <div class="alert alert-warning">
                    <strong>File Size Limits:</strong> Large datasets may take time to upload. Ensure stable internet connection for files over 100MB.
                </div>
            </section>

            <section id="gui-analysis-options">
                <h2>Analysis Options</h2>
                
                                 <h3>Analysis Mode Selection</h3>
                 <p>Choose between two main analysis modes:</p>
                 
                 <div class="screenshot-container">
                     <img src="{{ url_for('static', filename='imgs/selection_option_capgenie.png') }}" alt="Analysis Mode Selection" class="gui-screenshot">
                     <div class="screenshot-caption">Analysis mode selection interface showing different options</div>
                 </div>

                <div class="parameter-group">
                    <h4>Barcode Analysis</h4>
                    <p>Use this mode when your samples are multiplexed with barcodes that map to tissues, replicates, or time points:</p>
                    <ul>
                        <li>Upload your barcode CSV mapping file</li>
                        <li>Select your FASTQ files or dataset folder</li>
                        <li>Run barcode counting and quality control</li>
                        <li>Download summary tables per barcode and per sample</li>
                    </ul>
                </div>

                                                 <div class="parameter-group">
                    <h4>Selection Analysis</h4>
                    <p>Use this mode to analyze peptide selections from a capsid library (e.g., AAV display) against tissues or cell types:</p>
                    <ul>
                        <li>Upload your capsid CSV library file</li>
                        <li>Optionally set mismatch tolerance for peptide matching</li>
                        <li>Compute counts, percentages, and enrichment across conditions</li>
                        <li>Generate bubble plots and biodistribution visualizations</li>
                    </ul>
                </div>



                <h3>Quality Control Options</h3>
                <table class="parameter-table">
                    <thead>
                        <tr>
                            <th>Option</th>
                            <th>Description</th>
                            <th>Default</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Quality Threshold</strong></td>
                            <td>Minimum quality score for read filtering</td>
                            <td>15</td>
                        </tr>

                                         </tbody>
                 </table>

                                  <div class="screenshot-container">
                    <img src="{{ url_for('static', filename='imgs/barcode_info_capgenie.png') }}" alt="Barcode Information" class="gui-screenshot">
                    <div class="screenshot-caption">Barcode information and file selection interface</div>
                </div>

                <div class="screenshot-container">
                    <img src="{{ url_for('static', filename='imgs/denoise_capgenie.png') }}" alt="Denoising Interface" class="gui-screenshot">
                    <div class="screenshot-caption">Denoising interface showing quality filtering options</div>
                </div>

                <div class="screenshot-container">
                    <img src="{{ url_for('static', filename='imgs/denoise_info_capgenie.png') }}" alt="Denoising Information" class="gui-screenshot">
                    <div class="screenshot-caption">Detailed denoising information and quality metrics</div>
                </div>

                <h3 id="gui-mismatches">Mismatch Types</h3>
                <p>When matching reads to peptides in Selection analysis, you may allow substitutions and optionally indels.</p>
                <div class="legend">
                    <span class="legend-item"><span class="legend-swatch nt-sub"></span>Substitution</span>
                    <span class="legend-item"><span class="legend-swatch nt-del"></span>Deletion</span>
                    <span class="legend-item"><span class="legend-swatch nt-ins"></span>Insertion</span>
                </div>
                <div class="nt-diagram nt-grid">
                    <div class="nt-row"><span class="nt-label">Ref</span>
                        <span class="nt">A</span><span class="nt">T</span><span class="nt">G</span>
                        <span class="nt">C</span><span class="nt">C</span><span class="nt">A</span>
                        <span class="nt">G</span><span class="nt">T</span><span class="nt">T</span>
                        <span class="nt">A</span><span class="nt">A</span><span class="nt">G</span>
                    </div>
                    <div class="nt-row"><span class="nt-label">Read</span>
                        <span class="nt">A</span><span class="nt">T</span><span class="nt">G</span>
                        <span class="nt nt-sub">Câ†’T</span><span class="nt">C</span><span class="nt">A</span>
                        <span class="nt">G</span><span class="nt">T</span><span class="nt">T</span>
                        <span class="nt">A</span><span class="nt">A</span><span class="nt">G</span>
                    </div>
                </div>
                <div class="nt-diagram nt-grid" aria-label="Deletion">
                    <div class="nt-row"><span class="nt-label">Ref</span>
                        <span class="nt">A</span><span class="nt">T</span><span class="nt">G</span>
                        <span class="nt">C</span><span class="nt">C</span><span class="nt">A</span>
                        <span class="nt">G</span><span class="nt">T</span><span class="nt">T</span>
                        <span class="nt">A</span><span class="nt">A</span><span class="nt">G</span>
                    </div>
                    <div class="nt-row"><span class="nt-label">Read</span>
                        <span class="nt">A</span><span class="nt">T</span><span class="nt">G</span>
                        <span class="nt nt-del">C</span><span class="nt nt-gap">Â·</span><span class="nt">A</span>
                        <span class="nt">G</span><span class="nt">T</span><span class="nt">T</span>
                        <span class="nt">A</span><span class="nt">A</span><span class="nt">G</span>
                    </div>
                </div>
                <div class="nt-diagram nt-grid" aria-label="Insertion">
                    <div class="nt-row"><span class="nt-label">Ref</span>
                        <span class="nt">A</span><span class="nt">T</span><span class="nt">G</span>
                        <span class="nt">C</span><span class="nt">C</span><span class="nt">A</span>
                        <span class="nt">G</span><span class="nt">T</span><span class="nt">T</span>
                        <span class="nt">A</span><span class="nt">A</span><span class="nt">G</span>
                    </div>
                    <div class="nt-row"><span class="nt-label">Read</span>
                        <span class="nt">A</span><span class="nt">T</span><span class="nt">G</span>
                        <span class="nt">C</span><span class="nt nt-ins">A</span><span class="nt">C</span><span class="nt">A</span>
                        <span class="nt">G</span><span class="nt">T</span><span class="nt">T</span>
                        <span class="nt">A</span><span class="nt">A</span><span class="nt">G</span>
                    </div>
                </div>



                <h3>Visualization Options</h3>
                <table class="parameter-table">
                    <thead>
                        <tr>
                            <th>Option</th>
                            <th>Description</th>
                            <th>Output</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Bubble Charts</strong></td>
                            <td>Generate interactive bubble chart visualizations</td>
                            <td>Interactive HTML charts</td>
                        </tr>
                        <tr>
                            <td><strong>Biodistribution</strong></td>
                            <td>Create frequency distribution charts</td>
                            <td>Distribution plots</td>
                        </tr>

                    </tbody>
                </table>
            </section>

                        <section id="gui-results">
                <h2>Viewing Results</h2>
                
                <h3>Enrichment</h3>
                <p>Compare peptide abundance between conditions to identify enriched sequences.</p>

                <h3>Percentage</h3>
                <p>View percentage composition per peptide/sample; useful for relative abundance.</p>
                <div class="screenshot-container">
                    <img src="{{ url_for('static', filename='imgs/percentage_capgenie.png') }}" alt="Percentage Results" class="gui-screenshot">
                    <div class="screenshot-caption">Percentage analysis and data tables</div>
                </div>

                <h3>Quality</h3>
                <p>Assess read-level quality thresholds and QC settings used.</p>
                <div class="screenshot-container">
                    <img src="{{ url_for('static', filename='imgs/quality_capgenie.png') }}" alt="Quality Settings" class="gui-screenshot">
                    <div class="screenshot-caption">Quality control settings and threshold configuration</div>
                </div>

                <h3>Motif</h3>
                <p>Explore sequence motifs and information content derived from selected peptides.</p>

                <h3>Results Dashboard</h3>
                <p>After analysis completion, results are presented in an organized dashboard:</p>
                
                <div class="screenshot-container">
                    <img src="{{ url_for('static', filename='imgs/percentage_capgenie.png') }}" alt="Results Dashboard" class="gui-screenshot">
                    <div class="screenshot-caption">Results dashboard showing percentage analysis and data tables</div>
                </div>
                
                <div class="feature-grid">
                    <div class="feature-card">
                        <h4>ðŸ“ˆ Summary Statistics</h4>
                        <p>Overview of analysis results including total reads, identified variants, and quality metrics.</p>
                    </div>
                    <div class="feature-card">
                        <h4>ðŸ“‹ Detailed Tables</h4>
                        <p>Comprehensive data tables showing peptide counts, frequencies, and enrichment values.</p>
                    </div>
                    <div class="feature-card">
                        <h4>ðŸ“Š Interactive Charts</h4>
                        <p>Dynamic visualizations that respond to user interactions and filtering.</p>
                    </div>
                    <div class="feature-card">
                        <h4>ðŸ’¾ Download Options</h4>
                        <p>Export results in multiple formats including Excel, CSV, and JSON.</p>
                    </div>
                </div>

                <h3>Data Export</h3>
                <p>Results can be downloaded in various formats:</p>
                <ul>
                    <li><strong>Excel (.xlsx):</strong> Formatted spreadsheets with multiple sheets</li>
                    <li><strong>CSV:</strong> Raw data for further analysis in other tools</li>
                    <li><strong>JSON:</strong> Structured data for programmatic access</li>
                    <li><strong>PDF Reports:</strong> Formatted reports for presentations</li>
                </ul>

                <h3>Session Management</h3>
                <p>Each analysis session is automatically saved and can be accessed later:</p>
                <ul>
                    <li>View analysis history</li>
                    <li>Re-run analyses with different parameters</li>
                    <li>Compare results between sessions</li>
                    <li>Share results with collaborators</li>
                </ul>
            </section>

            <!-- Mismatch Types moved into Analysis Options -->
            <section id="gui-mismatches" style="display:none;">
                <h2>Mismatch Types: Substitutions vs Indels</h2>
                <p>CapGenie supports flexible matching when aligning peptide-coding reads to a capsid library. Two primary mismatch categories exist:</p>

                                <h3>Substitutions</h3>
                <p>A substitution changes one nucleotide to another without altering read length.</p>
                <div class="legend">
                    <span class="legend-item"><span class="legend-swatch nt-sub"></span>Substitution</span>
                </div>
                <div class="nt-diagram nt-grid">
                    <div class="nt-row"><span class="nt-label">Ref</span>
                        <span class="nt">A</span><span class="nt">T</span><span class="nt">G</span>
                        <span class="nt">C</span><span class="nt">C</span><span class="nt">A</span>
                        <span class="nt">G</span><span class="nt">T</span><span class="nt">T</span>
                        <span class="nt">A</span><span class="nt">A</span><span class="nt">G</span>
                    </div>
                    <div class="nt-row"><span class="nt-label">Read</span>
                        <span class="nt">A</span><span class="nt">T</span><span class="nt">G</span>
                        <span class="nt nt-sub">Câ†’T</span><span class="nt">C</span><span class="nt">A</span>
                        <span class="nt">G</span><span class="nt">T</span><span class="nt">T</span>
                        <span class="nt">A</span><span class="nt">A</span><span class="nt">G</span>
                    </div>
                </div>
                <ul>
                    <li><strong>Effect:</strong> Same length, one base differs</li>
                    <li><strong>Use:</strong> Tolerate sequencing errors or SNP-like variation</li>
                </ul>

                                <h3>Indels (Insertions/Deletions)</h3>
                <p>Indels change read length by inserting or deleting bases.</p>
                <div class="legend">
                    <span class="legend-item"><span class="legend-swatch nt-del"></span>Deletion</span>
                    <span class="legend-item"><span class="legend-swatch nt-ins"></span>Insertion</span>
                </div>
                <div class="nt-diagram nt-grid" aria-label="Deletion">
                    <div class="nt-row"><span class="nt-label">Ref</span>
                        <span class="nt">A</span><span class="nt">T</span><span class="nt">G</span>
                        <span class="nt">C</span><span class="nt">C</span><span class="nt">A</span>
                        <span class="nt">G</span><span class="nt">T</span><span class="nt">T</span>
                        <span class="nt">A</span><span class="nt">A</span><span class="nt">G</span>
                    </div>
                    <div class="nt-row"><span class="nt-label">Read</span>
                        <span class="nt">A</span><span class="nt">T</span><span class="nt">G</span>
                        <span class="nt nt-del">C</span><span class="nt nt-gap">Â·</span><span class="nt">A</span>
                        <span class="nt">G</span><span class="nt">T</span><span class="nt">T</span>
                        <span class="nt">A</span><span class="nt">A</span><span class="nt">G</span>
                    </div>
                </div>
                <div class="nt-diagram nt-grid" aria-label="Insertion">
                    <div class="nt-row"><span class="nt-label">Ref</span>
                        <span class="nt">A</span><span class="nt">T</span><span class="nt">G</span>
                        <span class="nt">C</span><span class="nt">C</span><span class="nt">A</span>
                        <span class="nt">G</span><span class="nt">T</span><span class="nt">T</span>
                        <span class="nt">A</span><span class="nt">A</span><span class="nt">G</span>
                    </div>
                    <div class="nt-row"><span class="nt-label">Read</span>
                        <span class="nt">A</span><span class="nt">T</span><span class="nt">G</span>
                        <span class="nt">C</span><span class="nt nt-ins">A</span><span class="nt">C</span><span class="nt">A</span>
                        <span class="nt">G</span><span class="nt">T</span><span class="nt">T</span>
                        <span class="nt">A</span><span class="nt">A</span><span class="nt">G</span>
                    </div>
                </div>
                <ul>
                    <li><strong>Effect:</strong> Length changes, alignment must account for gaps</li>
                    <li><strong>Use:</strong> Rare in peptide libraries; increases compute; consider enabling only when expected</li>
                </ul>

                <div class="alert alert-info">
                    <strong>Tip:</strong> Start with substitutions-only for speed. Enable indels only if you expect frameshifts or design-specific insertions/deletions.
                </div>
            </section>

            <section id="gui-visualizations">
                <h2>Interactive Visualizations</h2>
                
                                 <h3>Bubble Charts</h3>
                 <p>Interactive bubble charts display peptide frequency data:</p>
                 
                 <div class="screenshot-container">
                     <img src="{{ url_for('static', filename='imgs/bubble_modal_capgenie.png') }}" alt="Bubble Chart Modal" class="gui-screenshot">
                     <div class="screenshot-caption">Interactive bubble chart modal with detailed visualization controls</div>
                 </div>
                 
                 <ul>
                     <li><strong>Bubble Size:</strong> Represents frequency or count</li>
                     <li><strong>Color Coding:</strong> Indicates different categories or conditions</li>
                     <li><strong>Hover Information:</strong> Detailed data on mouse hover</li>
                     <li><strong>Zoom and Pan:</strong> Explore large datasets interactively</li>
                 </ul>

                <h3>Biodistribution Charts</h3>
                <p>Frequency distribution visualizations show:</p>
                <ul>
                    <li>Peptide frequency across different samples</li>
                    <li>Comparative analysis between conditions</li>
                    <li>Statistical significance indicators</li>
                    <li>Export capabilities for publications</li>
                </ul>



                <h3>Customization Options</h3>
                <p>Visualizations can be customized:</p>
                <ul>
                    <li>Color scheme selection</li>
                    <li>Chart type alternatives</li>
                    <li>Data filtering and subsetting</li>
                    <li>Export in high-resolution formats</li>
                </ul>
            </section>

            <section id="gui-troubleshooting">
                <h2>GUI Troubleshooting</h2>
                
                <h3>Common Issues</h3>
                
                <div class="alert alert-warning">
                    <strong>Upload Failures:</strong> Check file formats and ensure files are not corrupted. Large files may require more time to upload.
                </div>
                
                                 <div class="alert alert-warning">
                     <strong>Analysis Errors:</strong> Verify that all required files are uploaded and parameters are correctly configured.
                 </div>

                                  <div class="alert alert-warning">
                    <strong>Browser Issues:</strong> Ensure you're using a modern browser (Chrome, Firefox, Safari, Edge) with JavaScript enabled.
                </div>

                <h3>Performance Optimization</h3>
                <ul>
                    <li>Use quality filtering to reduce dataset size</li>
                    <li>Close unnecessary browser tabs during analysis</li>
                    <li>Ensure stable internet connection for large uploads</li>
                    <li>Consider processing very large datasets in smaller batches</li>
                </ul>

                <h3>Getting Help</h3>
                <p>If you encounter issues:</p>
                <ul>
                    <li>Check this documentation section</li>
                    <li>Review the CLI documentation for technical details</li>
                    <li>Contact your system administrator for account issues</li>
                    <li>Ensure all required dependencies are available</li>
                </ul>

                <h3>Best Practices</h3>
                <ul>
                    <li>Use descriptive dataset names for easy organization</li>
                    <li>Review analysis parameters before starting</li>
                    <li>Download results promptly to avoid storage issues</li>
                    <li>Keep browser updated for best performance</li>
                                 </ul>
             </section>
             </section>
        </main>
    </div>

    <footer>
        <p>&copy; 2024 CapGenie. Advanced DNA Analysis Platform.</p>
    </footer>

    <script>
        // Smooth scrolling for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Update active navigation based on scroll position
        window.addEventListener('scroll', () => {
            const sections = document.querySelectorAll('section[id]');
            const navLinks = document.querySelectorAll('.docs-sidebar a');
            
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                if (pageYOffset >= sectionTop - 100) {
                    current = section.getAttribute('id');
                }
            });

            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === `#${current}`) {
                    link.classList.add('active');
                }
            });

            // Update section headers
            const sectionHeaders = document.querySelectorAll('.section-header');
            sectionHeaders.forEach(header => {
                header.classList.remove('active');
                const targetId = header.getAttribute('href').substring(1);
                if (current.startsWith(targetId.replace('-section', ''))) {
                    header.classList.add('active');
                }
            });
        });
    </script>
</body>
</html> 